*************************************
	(C) 千狐服务 版权所有
	StockIns 自述文件
	www.Kilofox.Net
*************************************


软件名称：虚拟股市
英文名称：StockIns
版本编号：9.4.2
适用环境：Discuz! X2
发布日期：2011年6月10日


========================
    软件简介
========================

欢迎使用千狐 StockIns 虚拟股市系统！

StockIns 是一款模拟现实股市交易流程的 PHP 软件，是专为国内主流 PHP 论坛而开发的插件产品。该版本为 Discuz! 插件版。

1、技术实现
A) 主要编程语言为 PHP 、HTML 、Javascript （ Ajax ）、XML 。
B) 使用 MySQL 数据库存储数据。使用自带的表，不会与论坛数据或其它插件产生冲突。
C) 采用最先进的面向对象编程实现（OOP），绿色、开源、免费，代码规范，力求标准。
D) 兼容论坛风格，前、后台皮肤风格全部继承自 Discuz! X2 标准风格。

2、股市作用
A) 为论坛会员提供一个公平的娱乐竞技平台；活跃论坛气氛，增强论坛粘性。
B) 控制论坛积分与股市资金流向。
C) 通过收取“股票交易印花税”间接消耗会员剩余积分。

3、角色分配
A) 虚拟股市，股票发行和交易的场所，证券交易所“经纪人”。
B) 论坛管理员，股市“游戏规则”的制定者、证监会，拥有最高权限。
C) 论坛会员，在股市开户后成为“股民”，既可以作为投资者，购买他人的股票，又可以作为法人，发行自己的股票。

4、股票发行
A) 会员为筹集资本，通过“上市公司”发行股票。
B) 论坛管理员审核“上市公司”的合法性。“上市公司”通过审核后，所有股民均可申购股票。
C) 申购期过后，股票完全流通（系统自动完成）。

5、股票交易
A) 竞价买卖：买方出价最高者和卖方要价最低者优先成交（系统自动完成）。
B) 间接交易：买卖双方委托“经纪人”进行股票买卖。
C) 现货交易：股票买卖成交以后，马上办理交割清算手续，当场钱货两清（系统自动完成）。

6、竞技特性
A) 资产排行，谁拥有最多的股市财富？谁是当之无愧的大赢家？
B) 谁来控股，发行人，你愿意将自己的公司转送给其他股东吗？

7、后台管理
A) 近 50 项参数设置，助您打造个性化股市。
B) 股票管理、用户管理、交易管理、申请管理、新闻管理、实用工具、系统日志，一应俱全。

8、安全机制
A) 用户在不符合操作条件的情况下，按钮是不可用的。
B) 客户端表单验证机制，确保不合法的字符无法输入，不合法的输入无法提交。
C) 客户端与服务端双重验证机制，为股市的健康稳定运行保驾护航。

9、用户体验
A) 股票名称检测等采用 Ajax 技术，在输入字符的时候就可以看到相关的提示信息。
B) 重要的信息以不同颜色加亮显示。


==========================
    安装与升级
==========================
1、软件运行环境需求及安装步骤，请阅读“安装指南”。
2、升级到 V9.4.2 之前，须将原目录 /source/plugin/stock/ 改名为 /source/plugin/stock_dzx/ 。
3、点击后台插件列表中“虚拟股市”一行的“设计”，将“唯一标识符(identifier)”一项修改为 stock_dzx ，将“插件目录(directory)”一项修改为 stock_dzx/ 。
4、从 V9.3.X 升级到 V9.4.2 ：上传并覆盖所有文件，点击后台插件列表中“虚拟股市”一行的“升级”，即可完成升级操作。
5、从 V9.4.0 Beta 升级到 V9.4.2 ：删除 /source/plugin/stock_dzx/upgrade.php ；将 upgrade_940b.php 改名为 upgrade.php ；上传并覆盖所有文件，点击后台插件列表中“虚拟股市”一行的“升级”，即可完成升级操作。
6、从 V9.4.0 Beta 2 升级到 V9.4.2 ：删除 /source/plugin/stock_dzx/upgrade.php ；将 upgrade_940b2.php 改名为 upgrade.php ；上传并覆盖所有文件，点击后台插件列表中“虚拟股市”一行的“升级”，即可完成升级操作。
7、从 V9.4.1 升级到 V9.4.2 ：上传并覆盖所有文件。


==========================
    更新列表
==========================

V9.3.0 (u20110417):
以 StockIns v9.3.4 for phpwind 为核心的新一代 Discuz! 虚拟股市插件开发工作基本完成。

V9.3.1 (u20110426):
后台增加“资金兑换积分种类”设置，默认使用论坛“交易积分”。
新增股民开户要求项目自适应后台“资金兑换积分种类”设置。
新增股民帐户论坛积分自适应后台“资金兑换积分种类”设置。
用户无积分开户情况下“已达数量”显示为“0”。
修正用户无积分开户情况下，提示“您现在不符合要求，暂时不能开户”，无法继续开户的问题。
修正“新股民开户”页下方显示多余页面的问题。
删除安装与卸载文件中已废弃的 kfsm_config 表相关内容。
修正“营业大厅”公司上市消息中，距离公司正式上市时间始终不变的问题。
修正“营业大厅”中，“综合指数”、“成交总量”、“成交金额”、“印花收入”数值错误的问题。
修正“新闻中心”新闻标题链接指向错误的问题。
“新闻阅读”页左侧菜单，由高亮显示“营业大厅”，修改为高亮显示“新闻中心”。
“新闻阅读”页支持解析 Discuz! 代码。
修正“资产排行”页股民链接指向错误的问题。
修正“股民信息”页股民名字显示为“-”的问题。
修正股民无法存款、取款、转帐的问题。
修正后台删除用户页不显示被删除用户名字的问题。
修正后台无法删除用户的问题。
修正后台编辑用户信息页各项数值显示错误的问题。
修正后台无法编辑用户信息的问题。
修正后台删除用户后，“系统日志”中“对象”为空的问题。
调整后台“编辑用户”、“删除用户”、“系统日志”、“交易记录”、“用户管理”、“股票管理”、“编辑新闻”、“发布新闻”、“交易记录”等页面风格，以适应 Discuz! X2 后台风格。
修正后台所有提示信息出现前台页面的问题。
修正股票搜索输入不正确信息返回时，提示“抱歉，您无权使用此功能”的问题。
公司上市新闻链接用 Discuz! 代码“[url]”代替 HTML 标签“<a>”。
修正后台添加新闻时，如果未填写新闻标题或新闻内容，提交后提示“annouce_empty”的问题。
修正后台添加新闻时，提交后页面空白，无法添加成功的问题。
修正后台“新闻管理”中，点击“新闻标题”后，目标页面提示“插件不存在或已关闭”的问题。
后台“新闻管理”的“新闻标题”显示 50 个字符。
修正“系统日志”中“操作者”为空的问题。
修正后台“实用工具”各“提交”按钮无效的问题。
修正后台编辑股票信息页各项数值显示错误的问题。
修正后台无法编辑股票信息的问题。
修正后台编辑股票信息页不显示股票名称的问题。
修正后台编辑股票信息页“公司照片”下拉列表无选项的问题。
修正后台编辑股票信息页“上市公司简介”字数提示信息不显示数值的问题。
后台编辑股票信息页增加“是否停牌”选项开关。
修正后台“交易记录”删除空记录时出现 MySQL 错误的问题。
修正后台“系统日志”删除空记录时出现 MySQL 错误的问题。
修正后台“系统日志”删除记录时，出现 MySQL 错误，并且无法记录本次删除操作的问题。
允许修改后台“新闻管理”中的系统新闻。
修正“股市大厅”“涨幅前五”与“跌幅前五”中的股票链接指向错误问题。
修正股票交易页无法正确显示问题。
调整股票交易页风格，以适应 Discuz! X2 风格。
修正股票交易页“卖出数量”上限为非数值的问题。
修正交易股票时提示“股市限制：离允许再次挂单买入该股票还差 0 分钟！”的问题。
修正“今日交易记录”页“股票代码”和“股票名称”链接指向错误的问题。
调整“今日交易记录”页“撤单”按钮风格。
修正“股票资料”页“大股东持股比例”大于 100% 的问题。
修正“股票资料”页不显示“最近 24 小时价格走势”图的问题。
修正“营业大厅”“新股上市”消息倒计时“小时数”异常变大的问题。
修正“允许游客访问股市”开关无效的问题。
清理个别类中的未使用变量、方法；全方位优化。
其它细节调整。

V9.3.2 (u20110505):
修正上市公司资料页“最近 24 小时价格走势”不显示的问题。
删除“交易记录”右侧内容，以加宽“今日交易记录”显示。
修正无法分红的问题。
修正“股市大厅” JavaScript 错误；在“股市信息”一栏中显示当前（动态）时间。
调整“股市大厅”的“涨幅前五”与“跌幅前五”表现样式。
修正新股上市系统提示新闻标题与内容不显示上市时间的问题。

V9.4.0 Beta (u20110516):
修正无法撤单的问题。
修正委托交易完成后部分数据计算错误的问题。
修正买入股票后错误变更“控股人”的问题。
委托交易页右侧的“最新买入价格”与“最新卖出价格”整合为“五档盘口”，按委托价分组倒序排列。
修正委托交易页“买入数量”或“卖出数量”区间可能会出现左端点大于右端点的问题。
修正当股票剩余数量小于 10 股时无法卖出的问题。
修正股票每月一次（上市日）的价格涨跌幅度不受限制的问题。
股票价格涨跌幅度不受限制时间，由“正式上市第一天”，更改为“正式上市起24小时内”。
查看申购阶段的股票信息，自动跳转至申购交易界面。
后台“用户管理”的“正常”状态以绿色加亮显示。
后台“股票管理”的“新股”状态以蓝色加亮显示。
后台“股票管理”的“停牌”状态以灰色加亮显示。
修正后台编辑股票页“是否停牌”两个选项功能相反的问题。
修正“公司上市”的“公司简介”中出现特殊字符时，后台“批准”出现 MySQL 错误的问题。
修正“行情中心”搜索股票出现“插件不存在或已关闭”提示的问题。
股票资料页的“最近 24 小时价格走势”转移到委托交易页显示。
委托交易页右侧的“股民帐户”移到“五档盘口”下方显示。
未成交的委托交易价格不再影响“最新价”。
修正申购股票页“买入数量”区间可能会出现左端点大于右端点的问题。
修正后台“交易记录”中，点击“股票代码”出现空白页面的问题。
全新股票交易系统，全新交易规则，“委托”与“成交”分离，增加“部分成交”状态。

V9.4.0 Beta 2 (u20110522):
“交易记录”更名为“交易查询”，拆分成“交易记录”、“成交记录”查询功能。
后台“交易记录”更名为“交易管理”，拆分成“委托记录”、“成交记录”两个管理模块。
后台删除“委托记录”、“成交记录”时，“系统日志”自动记录被删除条数；删除空记录时不记录被删除条数。
后台删除“委托记录”、“成交记录”后，返回的删除成功信息以 succeed 样式显示。
后台删除“系统日志”时，“系统日志”自动记录被删除条数；删除空记录时不记录被删除条数。
修正公司资料页“股东列表”中，点击股东名字提示“插件不存在或已关闭”的问题。
“今日委托记录”改为“委托记录”，显示最近30天的委托记录。
后台“委托记录”、“成交记录”保留天数由 3 天改为 30 天。
修正股票交易页，当没有该股票时，“卖出数量”区间左端点不显示数值的问题。
申购同一股票间隔分钟数向上取整，小于1分钟时将提示“股市限制：离允许再次买入该股票还差 1 分钟！”。
委托买入同一股票间隔分钟数向上取整，小于1分钟时将提示“股市限制：离允许再次买入该股票还差 1 分钟！”。
委托卖出同一股票间隔分钟数向上取整，小于1分钟时将提示“股市限制：离允许再次卖出该股票还差 1 分钟！”。
修正点击“行情中心”的“控股人”提示“插件不存在或已关闭”的问题。
修正公司资料页，点击“法人代表”或“控股人”提示“插件不存在或已关闭”的问题。
修正点击“公司上市申请一览表”的“申请人”提示“插件不存在或已关闭”的问题。
修正点击分红页“股东”提示“插件不存在或已关闭”的问题。
前台页面风格全面更新。
修正游客无法访问股市的问题。
未登录用户在“新股民开户”页发帖数量显示为 0 帖。
未登录用户开户跳转到“营业大厅”。
修正后台“股票管理”、“用户管理”、“系统日志”异常分页的问题。
修正“资产排行”异常分页的问题。

V9.4.1 (u20110606):
修正委托买入股票成交时，卖方挂单数量不减少的问题。
修正委托买入股票不挂单的问题。
修正委托交易页“买入数量”与“卖出数量”不过滤非法字符，不计算“所需费用”的问题。
更新部分前台页面风格。
股票价格上下限定为 999.99 元。
修正股票申购页“申购数量”不过滤非法字符，不计算“所需费用”的问题。
股票交易页“五档盘口”卖盘由显示五条最高委托价改为显示五条最低委托价。
股票交易页“五档盘口”委托价格高于当开盘时以红色加亮；低于开盘价时以绿色加亮显示；等于开盘价时以黑色加亮显示。
股票申购数量设置上限为上市数量的10%。
修正上市公司资料页“股东列表”异常分页的问题。
修正“新闻中心”新闻列表异常分页的问题。
更新前台所有分页导航风格。
“公司上市”拆分为“上市一览”和“申请上市”。增加“公司上市申请一览表”分页显示功能。
修正第二次申购股票后“平均价格”计算错误。
移除后台“异常股票报告”，增加“股市信息报告”。
修正委托买入股票“部分成交”后，次日不返还资金的问题。
委托买入股票未成交时，不再扣除股票交易印花税。
修正委托卖出股票时，可能会删除已持有股票的问题。
修正委托记录中“成交”状态可能会显示为“部分成交”的问题。
修正“分红送股”提示“请输入正确的送股数量”的问题。
修正“行情中心”各项排序指标无效的问题。
取消公司上市后24小时之内股票不限涨跌停。
增加相同IP用户交易时间限制功能，并且后台可控。
会员不满足开户要求时，显示不可用的“开户”按钮。

V9.4.2 (u20110610):
修正股市大厅不显示“跌幅前五”股票名称的问题。
修正新股民无法开户的问题。
“股市交易规则”重要信息以特殊颜色加亮显示。